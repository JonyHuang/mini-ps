(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"1a9c":function(t,i,n){"use strict";(function(t){function e(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{},e=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.forEach(function(i){o(t,i,n[i])})}return t}function o(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(){return n.e("pages/index/imgEdit").then(n.bind(null,"31e2"))},a=function(){return n.e("pages/index/fontEdit").then(n.bind(null,"87cf"))},r=function(){return Promise.all([n.e("common/vendor"),n.e("pages/index/canvasEdit")]).then(n.bind(null,"7eb0"))},f=function(){return n.e("pages/index/zxColor").then(n.bind(null,"2c93"))},h=function(){return n.e("pages/index/info").then(n.bind(null,"3170"))},c=function(){return n.e("pages/index/generateImg").then(n.bind(null,"5984"))},g={components:{imgEdit:s,fontEdit:a,canvasEdit:r,zxColor:f,zxInfo:h,generateImg:c},data:function(){return{imageList:[],textList:[],textActive:-1,imgActive:-1,curColor:"#000",isShow:!0,timer:null,activeGenerate:!1,btnType:{font:{range1:"字体大小",range2:"行间距",btn1:"居中",btn2:"加粗",btn3:"颜色",btn4:"贯穿"},img:{range1:"圆角半径",range2:"旋转角度",btn1:"居中",btn2:"铺满",btn3:"置顶",btn4:"置底"},canvas:{range1:"笔画大小",range2:"笔锋程度",btn1:"清空",btn2:"保存",btn3:"颜色",btn4:"确认"}},defaultConfig:{imgPosition:{x:50,y:50,w:200},fontPosition:{x:50,y:50,w:200},img:{r:0,degrees:0,shadow:!1,mirror:!1},font:{lineHeight:14,size:14,weight:!1,lineThrough:!1,color:"#000"},canvas:{color:"#000",lineWidth:2,keenness:0}},editType:null,container:{w:null,h:null},imgConfig:{},fontConfig:{},canvasConfig:{},inputContent:"",imageSrc:null,textSrc:null}},watch:{textActive:function(t){t>-1?("font"!==this.editType&&(this.imgActive=-1,this.editType="font"),console.log(this.textList[t].config,t+"val"),this.fontConfig=this.textList[t].config,this.inputContent=this.textList[t].content):-1===this.imgActive&&-1===this.textActive&&"canvas"!==this.editType&&(this.editType=null)},imgActive:function(t){t>-1?("img"!==this.editType&&(this.textActive=-1,this.editType="img"),this.imgConfig=this.imageList[t].config):-1===this.imgActive&&-1===this.textActive&&"canvas"!==this.editType&&(this.editType=null)},editType:function(t){t&&"canvas"!==t||(this.textActive=-1,this.imgActive=-1,this.inputContent="")}},onReady:function(){this.imgConfig=JSON.parse(JSON.stringify(this.defaultConfig.img)),this.fontConfig=JSON.parse(JSON.stringify(this.defaultConfig.font)),this.canvasConfig=JSON.parse(JSON.stringify(this.defaultConfig.canvas)),this.k=t.getSystemInfoSync().screenWidth/750,this.setContainerW()},methods:{px2rpx:function(){if(1==arguments.length)return arguments[0]/this.k;var t=[],i=!0,n=!1,e=void 0;try{for(var o,s=arguments[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;t.push(a/this.k||0)}}catch(r){n=!0,e=r}finally{try{i||null==s.return||s.return()}finally{if(n)throw e}}return t},rpx2px:function(){if(1==arguments.length)return arguments[0]*this.k;var t=[],i=!0,n=!1,e=void 0;try{for(var o,s=arguments[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;t.push(a*this.k||0)}}catch(r){n=!0,e=r}finally{try{i||null==s.return||s.return()}finally{if(n)throw e}}return t},cancelEditType:function(){this.editType=null},handleImgType:function(){if("img"!==this.editType){var i=this.imageList.length;i?this.imgActive=i-1:t.showModal({title:"提示",content:"请点击调控板左下角插入图片",showCancel:!1})}},handleFontType:function(){if("font"!==this.editType){var i=this.textList.length;i?this.textActive=i-1:t.showModal({title:"提示",content:"请点击调控板左下角插入文字",showCancel:!1})}},setContainerW:function(){this.container.w=this.rpx2px(720),this.container.h=this.rpx2px(880)},getColor:function(t){this.curColor=t,this.$refs.font.handleFontColor(t),this.canvasConfig.color=t},uploadImg:function(){var i=this;t.chooseImage({count:1,sourceType:["album","camera"],success:function(n){t.getImageInfo({src:n.tempFilePaths[0],success:function(t){i.imageList.push({src:n.tempFilePaths[0],position:e({},i.defaultConfig.imgPosition,{h:200*t.height/t.width}),config:e({},i.defaultConfig.img),isMove:!1}),i.textActive=-1,i.imgActive=i.imageList.length-1,i.editType="img"}})}})},handleText:function(){this.inputContent?"font"!==this.editType?(this.defaultConfig.font.color=this.curColor,this.textList.push({content:this.inputContent,position:this.defaultConfig.fontPosition,config:this.defaultConfig.font,isMove:!1}),this.imgActive=-1,this.textActive=this.textList.length-1,this.editType="font"):this.textList[this.textActive].content=this.inputContent:t.showModal({title:"提示",content:"编辑内容不能为空",showCancel:!1})},handleCanvasType:function(){this.editType="canvas"},tapTopBtn1:function(){var i=this;t.showModal({title:"提示",content:"是否清空绘画板",success:function(t){t.confirm&&(i.textList=[],i.imageList=[],i.editType=null)}})},tapTopBtn2:function(){this.imgActive>-1?(this.imageList.splice(this.imgActive,1),this.imgActive=-1):this.textActive>-1&&(this.textList.splice(this.textActive,1),this.textActive=-1)},tapTopBtn3:function(){this.imgConfig.shadow=!this.imgConfig.shadow,this.$refs.img.handleImgShadow(this.imgConfig.shadow)},tapTopBtn4:function(){this.imgConfig.mirror=!this.imgConfig.mirror,this.$refs.img.handleImgMirror(this.imgConfig.mirror)},info:function(){this.$refs.info.openInfo()},close:function(){this.isShow=!1},unfold:function(){this.isShow=!0},tapRange1:function(t){switch(this.editType){case"img":if(this.imgConfig.r+t<0)return;this.imgConfig.r=1*this.imgConfig.r+t,this.$refs.img.handleImgR(this.imgConfig.r);break;case"font":if(this.fontConfig.size+t<0)return;this.fontConfig.size=1*this.fontConfig.size+t,this.$refs.font.handleFontSize(this.fontConfig.size);break;case"canvas":if(this.canvasConfig.lineWidth+t<0||this.canvasConfig.lineWidth+t>5)return;this.canvasConfig.lineWidth=1*this.canvasConfig.lineWidth+t;break;default:break}},longpressRange1:function(t){var i=this;switch(this.editType){case"img":this.timer=setInterval(function(){i.imgConfig.r+t<0||(i.imgConfig.r=1*i.imgConfig.r+t,i.$refs.img.handleImgR(i.imgConfig.r))},30);break;case"font":this.timer=setInterval(function(){i.fontConfig.size+t<0||(i.fontConfig.size=1*i.fontConfig.size+t,i.$refs.font.handleFontSize(i.fontConfig.size))},30);break;case"canvas":break;default:break}},touchendRange1:function(){clearInterval(this.timer),this.timer=null},tapRange2:function(t){switch(this.editType){case"img":this.imgConfig.degrees=1*this.imgConfig.degrees+t,this.$refs.img.handleImgDegrees(this.imgConfig.degrees);break;case"font":if(this.fontConfig.lineHeight+t<0)return;this.fontConfig.lineHeight=1*this.fontConfig.lineHeight+t,this.$refs.font.handleFontLineHeight(this.fontConfig.lineHeight);break;case"canvas":if(this.canvasConfig.keenness+t<0||this.canvasConfig.keenness+t>5)return;this.canvasConfig.keenness=1*this.canvasConfig.keenness+t;break;default:break}},longpressRange2:function(t){var i=this;switch(this.editType){case"img":this.timer=setInterval(function(){i.imgConfig.degrees=1*i.imgConfig.degrees+t,i.$refs.img.handleImgDegrees(i.imgConfig.degrees)},30);break;case"font":this.timer=setInterval(function(){i.fontConfig.lineHeight+t<0||(i.fontConfig.lineHeight=1*i.fontConfig.lineHeight+t,i.$refs.font.handleFontLineHeight(i.fontConfig.lineHeight))},30);break;case"canvas":break;default:break}},touchendRange2:function(){clearInterval(this.timer),this.timer=null},tapBtn1:function(){switch(this.editType){case"img":this.$refs.img.handleImgCenter(this.container.w);break;case"font":this.$refs.font.handleFontCenter(this.container.w);break;case"canvas":this.$refs.canvas.handleClear();break;default:break}},tapBtn2:function(){switch(this.editType){case"img":this.$refs.img.handleImgFullContainer(this.container.w);break;case"font":this.fontConfig.weight=!this.fontConfig.weight,this.$refs.font.handleFontWeight(this.fontConfig.weight);break;case"canvas":this.$refs.canvas.save();break;default:break}},tapBtn3:function(){switch(this.editType){case"img":this.$refs.img.handleImgSet2top();break;case"font":this.$refs.color.handldWin();break;case"canvas":this.$refs.color.handldWin();break;default:this.$refs.color.handldWin();break}},tapBtn4:function(){switch(this.editType){case"img":this.$refs.img.handleImgSet2bottom();break;case"font":this.fontConfig.lineThrough=!this.fontConfig.lineThrough,this.$refs.font.handleFontLineThrough(this.fontConfig.lineThrough);break;case"canvas":this.$refs.canvas.confirm();break;default:break}},handleCanvasImage:function(t,i){this.imageList.push({src:t,position:i,config:this.defaultConfig.img,isMove:!1}),this.imgActive=this.imageList.length-1,this.editType="img"},canvasAdjustMove:function(t){t.touches[0].clientY<110||(this.container.h=t.touches[0].clientY)},export2png:function(){var i=this;t.showLoading({mask:!0,title:"正在导出"});var n=[],e=!0,o=!1,s=void 0;try{for(var a,r=this.imageList[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var f=a.value,h=this.px2rpx(f.position.x,f.position.y,f.position.w,f.position.h,f.config.r);n.push({src:f.src,x:h[0],y:h[1],w:h[2],h:h[3],r:h[4],degrees:f.config.degrees,shadow:f.config.shadow,mirror:f.config.mirror})}}catch(C){o=!0,s=C}finally{try{e||null==r.return||r.return()}finally{if(o)throw s}}var c=[],g=!0,l=!1,u=void 0;try{for(var d,m=this.textList[Symbol.iterator]();!(g=(d=m.next()).done);g=!0){var p=d.value,v=this.px2rpx(p.position.x,p.position.y,p.position.w,p.config.lineHeight,p.config.size);c.push({content:p.content,x:v[0],y:v[1],w:v[2]-60,lineHeight:v[3],size:v[4],color:p.config.color,weight:p.config.weight?"bold":"normal",lineThrough:p.config.lineThrough})}}catch(C){l=!0,u=C}finally{try{g||null==m.return||m.return()}finally{if(l)throw u}}this.imageSrc=n,this.textSrc=c,this.activeGenerate=!0,setTimeout(function(){i.$refs.generate.generate()},600)},exportSuccess:function(i){t.hideLoading(),this.activeGenerate=!1,t.previewImage({urls:[i],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],fail:function(i){t.showModal({title:"错误提示",showCancel:!1,content:i.errMsg})}}})}}};i.default=g}).call(this,n("543d")["default"])},"27b1":function(t,i,n){"use strict";(function(t){n("ca5e"),n("921b");e(n("66fd"));var i=e(n("bfab"));function e(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,n("543d")["createPage"])},"35af":function(t,i,n){"use strict";var e,o=function(){var t=this,i=t.$createElement,n=(t._self._c,t.px2rpx(t.container.h));t.$mp.data=Object.assign({},{$root:{m0:n}})},s=[];n.d(i,"b",function(){return o}),n.d(i,"c",function(){return s}),n.d(i,"a",function(){return e})},"36c0":function(t,i,n){"use strict";n.r(i);var e=n("1a9c"),o=n.n(e);for(var s in e)"default"!==s&&function(t){n.d(i,t,function(){return e[t]})}(s);i["default"]=o.a},"7ba1":function(t,i,n){},bfab:function(t,i,n){"use strict";n.r(i);var e=n("35af"),o=n("36c0");for(var s in o)"default"!==s&&function(t){n.d(i,t,function(){return o[t]})}(s);n("f278");var a,r=n("f0c5"),f=Object(r["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],a);i["default"]=f.exports},f278:function(t,i,n){"use strict";var e=n("7ba1"),o=n.n(e);o.a}},[["27b1","common/runtime","common/vendor"]]]);